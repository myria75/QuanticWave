{% extends "base.html" %}
{% block title %}Circuit{% endblock %}

{% block titulo %}
<div style="text-align: center; background-color: #5F6F52;">
  <div style= "color: #FEFAE0">
    <h1>In-depth analysis of the circuit</h1>
  </div>
  <div style = "color: #ffff">
    <p>On this page you can see patterns and metrics of the circuits from the codes you ingested before. </p>
    <br>
  </div>
</div>
<br>
{% endblock %}

{% block content %}
<p>Select a file to see what characteristics it exhibits in patterns and metrics.</p>
<button type="button" class="btn btn-success btn-lg" data-toggle="modal" data-target="#modalCode">
    Show code
</button>
<br>
<div class="modal fade" id="modalCode" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header" style="text-align: center;">
                <h1 class="modal-title fs-5" id="exampleModalLabel" style="font-weight: bold;">Python_qiskit_qiskit-community_qiskit-algorithms_test.test_grover.py</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <pre><code class="language-python">
                import itertools
                import unittest
                from test import QiskitAlgorithmsTestCase
                import numpy as np
                from ddt import data, ddt, idata, unpack
                from qiskit import QuantumCircuit
                from qiskit.circuit.library import GroverOperator, PhaseOracle
                from qiskit.primitives import Sampler
                from qiskit.quantum_info import Operator, Statevector
                from qiskit.utils.optionals import HAS_TWEEDLEDUM
                from qiskit_algorithms import AmplificationProblem, Grover

                @ddt
                class TestAmplificationProblem(QiskitAlgorithmsTestCase):
                    def setUp(self):
                        super().setUp()
                        oracle = QuantumCircuit(2)
                        oracle.cz(0, 1)
                        self._expected_grover_op = GroverOperator(oracle=oracle)

                    @data("oracle_only", "oracle_and_stateprep")
                    def test_groverop_getter(self, kind):
                        oracle = QuantumCircuit(2)
                        oracle.cz(0, 1)

                        if kind == "oracle_only":
                            problem = AmplificationProblem(oracle, is_good_state=["11"])
                            expected = GroverOperator(oracle)
                        else:
                            stateprep = QuantumCircuit(2)
                            stateprep.ry(0.2, [0, 1])
                            problem = AmplificationProblem(
                                oracle, state_preparation=stateprep, is_good_state=["11"]
                            )
                            expected = GroverOperator(oracle, stateprep)

                        self.assertEqual(Operator(expected), Operator(problem.grover_operator))

                    @data("list_str", "list_int", "statevector", "callable")
                    def test_is_good_state(self, kind):
                        if kind == "list_str":
                            is_good_state = ["01", "11"]
                        elif kind == "list_int":
                            is_good_state = [1]  # means bitstr[1] == '1'
                        elif kind == "statevector":
                            is_good_state = Statevector(np.array([0, 1, 0, 1]) / np.sqrt(2))
                        else:

                    def is_good_state(bitstr):
                        return bitstr[1] == "1"

                        possible_states = [
                            "".join(list(map(str, item))) for item in itertools.product([0, 1], repeat=2)
                        ]

                        oracle = QuantumCircuit(2)
                        problem = AmplificationProblem(oracle, is_good_state=is_good_state)

                        expected = [state in ["01", "11"] for state in possible_states]
                        actual = [problem.is_good_state(state) for state in possible_states]

                        self.assertListEqual(expected, actual)

                if __name__ == "__main__":
                    unittest.main()
                </code></pre>
            </div>
        </div>
    </div>
</div>
<br>

<div class="row align-items-center;" style=" color: #A9B388;">
    <div class="col-6">
        <h1>Patterns:</h1>
    </div>
</div>
<br>

<form id="auto-submit-form" method="post">
    {{ form.csrf_token }}
    <div class="form-group container text-center">
      <div class="row align-items-center justify-content-center">
        <div class="col-auto">
          {{ form.path.label() }}:         
        </div>
        <div class="col-auto">
          {{ form.path(class="form-select", id="path", onchange="this.form.submit()") }}        
        </div>
      </div>
    </div>
</form>
<br><br>

<div class="overflow-auto">
    <table class="table table-hover">
        <thead style="">
            {% for headerP in table_header_Patterns %} 
                <th scope="col" style = "background-color: #A9B388; color:#ffff">{{ headerP }}</th>
            {% endfor %}        
        </thead>
        <tbody>
            {% for rowP in table_content_Patterns %}
            <tr>
                {% for itemP in rowP %}
                    {% if loop.index0 == 0 %}
                        <td><a href="{{ get_circuit_link(itemP) }}" target="_blank">{{ itemP }}</a></td>
                    {% else %}
                        {% if itemP == "True" %}
                            <td style="text-align:left;"><i class="bi bi-check-circle check-icon"></i></td>
                        {% elif itemP == "False" %}
                            <td></td>
                            <!--<td style="text-align: center;"><i class="bi bi-x-circle wrong-icon"></i></td>-->
                        {% else %}
                            <td>{{ itemP }}</td>
                        {% endif %}
                    {% endif %}
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<br>

<div class="row align-items-center;" style=" color: #A9B388;">
    <div class="col-6">
        <h1>Metrics:</h1>
    </div>
</div>
<br>
<div class="overflow-auto">
    <table class="table table-hover rtable rtable--flip">
        <thead style="">
            {% for headerM in table_header_Metrics %} 
                <th scope="col" style="background-color: #A9B388; color:#ffff">{{ headerM }}</th>
            {% endfor %}     
        </thead>
        <tbody>
            {% for rowM in table_content_Metrics %}
            <tr>
                {% for itemM in rowM %}
                    {% if loop.index0 == 0 %}
                        <td><a href="{{ get_circuit_link(itemM) }}" target="_blank">{{ itemM }}</a></td>
                    {% else %}
                        <td>{{ itemM }}</td>
                    {% endif %}
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script>
    document.getElementById('path').addEventListener('change', function() {
        document.getElementById('auto-submit-form').submit();
    });
</script>  
{% endblock %}